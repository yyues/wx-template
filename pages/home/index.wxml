<view class="page-wrapper">
  <!-- 导航栏 -->
  <van-nav-bar border="{{false}}" fixed placeholder="{{true}}" custom-style="background: #7174E2;">
    <view slot="left" class="nav-title">
      <view class="user" wx:if="{{ hasLogin}}">
        <image class="image" src="{{avatar_url}}"></image>
        <view class="name">
          <text>{{username}}</text>
        </view>
      </view>
      <text wx:else>Hi,请先登录！</text>
    </view>
  </van-nav-bar>
  <!-- 搜索框 -->
  <van-search value="{{ searchValue }}" placeholder="搜索你创建的任务" bind:search="onSearch" bind:cancel="onCancel" custom-class="my-search" background="#7174E2" custom-class="white-input" />
  <!-- 快捷操作栏 -->
  <view class="operation-wrapper">
    <van-grid column-num="3" border="{{false}}">
      <van-grid-item use-slot>
        <view class="extal" bindtap="onTodo">
          <image src="../../images/user/todo.png"></image>
          <text>待办</text>
        </view>
      </van-grid-item>
      <van-grid-item use-slot>
        <view class="extal" bindtap="onCircle">
          <image src="../../images/user/circle.png"></image>
          <text>圈子</text>
        </view>
      </van-grid-item>
      <van-grid-item use-slot>
        <view class="extal">
          <image src="../../images/user/message.png"></image>
          <text>广场</text>
        </view>
      </van-grid-item>
    </van-grid>
  </view>
  <!-- 今日待办 -->
  <view class="today">
    <view class="header">
      <text>今日待办</text>
    </view>
    <block wx:if="{{data.length !== 0}}">
      <view class="wrapper">
        <today-card wx:for="{{data}}" wx:key="id" data="{{item}}" loading="{{arr[index]}}" index="{{index}}" bindfinish="onFinish" binddetail="onDetail" />
      </view>
    </block>
    <view class="empty" wx:else>
      <van-empty description="今日还没有待办哦！" />
    </view>
  </view>
  <!-- 今日待办 详情操作栏 -->
  <van-action-sheet show="{{ show }}" title="详情" z-index="{{10001}}" bind:close="hidenAction" overlay="{{true}}">
    <view class="action-wrapper">
      <!-- 编辑 -->
      <van-cell title="编辑" bindtap="onEdit">
        <image slot="icon" class="img" src="../../images/action/edit.png"></image>
      </van-cell>
      <!-- 设置提醒时间 -->
      <van-cell title="设置提醒时间" bindtap="onClock">
        <image slot="icon" class="img" src="../../images/action/clock.png"></image>
      </van-cell>
      <!-- 邀请小伙伴一起参加 -->
      <van-cell center title="邀请小伙伴一起参加" wx:if="{{current.is_multiplayer }}">
        <image slot="icon" class="img" src="../../images/action/share.png"></image>
        <van-button slot="right-icon" plain type="info" bindtap='onShareAppMessage' open-type="share" block size="small" color="#5b67ca">一键邀请</van-button>
      </van-cell>
      <!-- 延期到明天 -->
      <van-cell title="延至明日" bindtap="onDelay">
        <image slot="icon" class="img spec" src="../../images/action/delay_v2.png"></image>
      </van-cell>
      <!-- 删除 -->
      <van-cell title="删除">
        <image slot="icon" class="img" src="../../images/action/delete.png"></image>
      </van-cell>
    </view>
  </van-action-sheet>
  <!-- 待办时间 选择提示 -->
  <van-dialog use-slot show="{{ showTime }}" theme="round" style="--dialog-border-radius: 8px" show-confirm-button="{{false}}">
    <van-datetime-picker type="time" value="{{ currentDate }}" min-hour="{{ minHour }}" bind:confirm="changeClock" bind:cancel="onClose" />
  </van-dialog>
  <van-toast id="van-toast" />
</view>